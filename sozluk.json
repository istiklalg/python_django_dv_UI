{
  '_index': 'atibalogs',
  '_type': '_doc',
  '_id': '903066',
  '_score': None,
  '_source': {
    'id': 903066,
    'logndx': '<341005>',
    'socketaddress': '192.168.1.50:514',
    'inetaddress': '192.168.1.50',
    'logdata': '<139>Feb  3 12:52:53 2021 192.168.1.50 cli[4163]: <341005> <ERRS> AP:18:64:72:c8:27:88 <192.168.1.50 18:64:72:C8:27:88>  Failed to establish SSL connection with Activate:(10) ASN date error, current date after',
    'port': '514',
    'credate': '2021-02-03 13:52:53',
    'logrefval': '<139>',
    'logdate': '2021-02-03 12:52:53',
    'logservice': 'cli',
    'logserviceno': '4163',
    'severity': '3',
    'event': 'Failed to establish SSL connection with Activate:(10) ASN date error, current date after',
    'macadress': '186472c82788',
    'outclass': 'Error'
  },
  'sort': [
    903066
  ]
}


    elastic_connection = Elasticsearch(host_list, scheme='http', port=9200, sniff_on_start=True, request_timeout=5)
    search_object = Search(using=elastic_connection, index="atibalogs")
    search = search_object.sort("-id")
    # search = search_object
    search = search_object[:1]
    search = search.query("term", **{"logndx": {"value": "<341005>"}})
    response = search.execute()

    print(len(response.hits))
    for hit in response.hits:
        # with open("sozluk.txt", "w", encoding="utf-8") as file:
        #     file.write(str(hit))
        print(hit)
        for x in hit:
            print(x, " : ", hit[x])


<Hit(atibalogs/864711): {'id': 864711, 'logndx': '<341005>', 'socketaddress': '192.1...}>
id  :  864711
logndx  :  <341005>
socketaddress  :  192.168.1.50:514
inetaddress  :  192.168.1.50
logdata  :  <139>Sep 14 15:37:43 2020 192.168.1.50 cli[4801]: <341005> <ERRS> AP:18:64:72:c8:27:88 <192.168.1.50 18:64:72:C8:27:88>  Failed to establish SSL connection with Activate:(10) ASN date error, current date after
port  :  514
credate  :  2020-09-14 16:37:43
logrefval  :  <139>
logdate  :  2020-09-14 15:37:43
logservice  :  cli
logserviceno  :  4801
severity  :  3
event  :  Failed to establish SSL connection with Activate:(10) ASN date error, current date after
macadress  :  186472c82788
outclass  :  Error

1
<Hit(atibalogs/700266): {'id': 700266, 'logndx': '<341005>', 'socketaddress': '192.1...}>
id  :  700266
logndx  :  <341005>
socketaddress  :  192.168.1.50:514
inetaddress  :  192.168.1.50
logdata  :  <139>Mar  2 09:02:41 2021 192.168.1.50 cli[4157]: <341005> <ERRS> AP:18:64:72:c8:27:88 <192.168.1.50 18:64:72:C8:27:88>  Failed to establish SSL connection with Activate:(10) ASN date error, current date after
port  :  514
credate  :  2021-03-02 10:02:41
logrefval  :  <139>
logdate  :  2021-03-02 09:02:41
logservice  :  cli
logserviceno  :  4157
severity  :  3
event  :  Failed to establish SSL connection with Activate:(10) ASN date error, current date after
uniqueid  :  ccc
outclass  :  Error


From log source ccc, Log Code <341005>, elastic id : 700266
{'id': 700266, 'logcode': '<341005>', 'uniqueid': 'ccc', 'ipaddress': '192.168.1.50', 
'logevent': 'Failed to establish SSL connection with Activate:(10) ASN date error, current date after', 
'severity': '3', 'credate': '2021-03-02 10:02:41', 'logdate': '2021-03-02 09:02:41', 
'socketaddress': '192.168.1.50:514', 'port': '514', 
'rawlog': '<139>Mar  2 09:02:41 2021 192.168.1.50 cli[4157]: <341005> <ERRS> AP:18:64:72:c8:27:88 <192.168.1.50 18:64:72:C8:27:88>  Failed to establish SSL connection with Activate:(10) ASN date error, current date after', 
'logpri': '<139>', 'logservice': 'cli', 'logserviceno': '4157', 'outclasstype': 'Error'}
-----------------

from source ccc, Log Code <341005>, elastic id : 700266
{'id': 700266, 'logcode': '<341005>', 'uniqueid': 'ccc', 'ipaddress': '192.168.1.50', 'logevent': 'Failed to establish SSL connection with Activate:(10) ASN date error, current date after', 'severity': '3', 'credate': datetime.datetime(2021, 3, 2, 10, 2, 41), 'logdate': datetime.datetime(2021, 3, 2, 9, 2, 41), 'socketaddress': '192.168.1.50:514', 'port': '514', 'rawlog': '<139>Mar  2 09:02:41 2021 192.168.1.50 cli[4157]: <341005> <ERRS> AP:18:64:72:c8:27:88 <192.168.1.50 18:64:72:C8:27:88>  Failed to establish SSL connection with Activate:(10) ASN date error, current date after', 'logpri': '<139>', 'logservice': 'cli', 'logserviceno': '4157', 'outclasstype': 'Error'}
-----------------
from source ccc, Log Code <341005>, elastic id : 699829
{'id': 699829, 'logcode': '<341005>', 'uniqueid': 'ccc', 'ipaddress': '192.168.1.50', 'logevent': 'Failed to establish SSL connection with Activate:(10) ASN date error, current date after', 'severity': '3', 'credate': datetime.datetime(2021, 3, 2, 9, 57, 38), 'logdate': datetime.datetime(2021, 3, 2, 8, 57, 38), 'socketaddress': '192.168.1.50:514', 'port': '514', 'rawlog': '<139>Mar  2 08:57:38 2021 192.168.1.50 cli[4157]: <341005> <ERRS> AP:18:64:72:c8:27:88 <192.168.1.50 18:64:72:C8:27:88>  Failed to establish SSL connection with Activate:(10) ASN date error, current date after', 'logpri': '<139>', 'logservice': 'cli', 'logserviceno': '4157', 'outclasstype': 'Error'}
-----------------
from source ccc, Log Code <341005>, elastic id : 699478
{'id': 699478, 'logcode': '<341005>', 'uniqueid': 'ccc', 'ipaddress': '192.168.1.50', 'logevent': 'Failed to establish SSL connection with Activate:(10) ASN date error, current date after', 'severity': '3', 'credate': datetime.datetime(2021, 3, 2, 9, 52, 35), 'logdate': datetime.datetime(2021, 3, 2, 8, 52, 35), 'socketaddress': '192.168.1.50:514', 'port': '514', 'rawlog': '<139>Mar  2 08:52:35 2021 192.168.1.50 cli[4157]: <341005> <ERRS> AP:18:64:72:c8:27:88 <192.168.1.50 18:64:72:C8:27:88>  Failed to establish SSL connection with Activate:(10) ASN date error, current date after', 'logpri': '<139>', 'logservice': 'cli', 'logserviceno': '4157', 'outclasstype': 'Error'}
-----------------
from source ccc, Log Code <341005>, elastic id : 699166
{'id': 699166, 'logcode': '<341005>', 'uniqueid': 'ccc', 'ipaddress': '192.168.1.50', 'logevent': 'Failed to establish SSL connection with Activate:(10) ASN date error, current date after', 'severity': '3', 'credate': datetime.datetime(2021, 3, 2, 9, 47, 32), 'logdate': datetime.datetime(2021, 3, 2, 8, 47, 32), 'socketaddress': '192.168.1.50:514', 'port': '514', 'rawlog': '<139>Mar  2 08:47:32 2021 192.168.1.50 cli[4157]: <341005> <ERRS> AP:18:64:72:c8:27:88 <192.168.1.50 18:64:72:C8:27:88>  Failed to establish SSL connection with Activate:(10) ASN date error, current date after', 'logpri': '<139>', 'logservice': 'cli', 'logserviceno': '4157', 'outclasstype': 'Error'}
-----------------



elastic_connection = Elasticsearch(host_list, scheme='http', port=9200, sniff_on_start=True, request_timeout=5)
search_object = Search(using=elastic_connection, index="atibalogs")
search = search_object[:2].sort("-id")
# search = search_object[:2]
search = search.query("term", **{"logndx": {"value": "<341005>"}})
response = search.execute()
logsFromElastic = [LogFromElastic(hit) for hit in response.hits]
for log in logsFromElastic:
	print(log)